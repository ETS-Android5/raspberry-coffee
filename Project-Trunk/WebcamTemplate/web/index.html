<!DOCTYPE html>
<html lang="en">
<!--
 ! Uses ES6 Promises to get to Ajax
 +-->
<head>
	<meta charset="UTF-8">
	<title>Snapshot</title>
	<link rel="stylesheet" href="./stylesheet.css" type="text/css"/>
	<script type="text/javascript" src="./ajax.manager.js"></script> <!-- Contains REST calls -->

	<script type="text/javascript">

		function updateImage() {
			fetchPix(json => {
				console.log("Got this:", json);
				let imgUrl = location.protocol + '//' + location.host + '/' + json.snapUrl;
				document.getElementById("the-picture").innerHTML =
						`<img src="${imgUrl}" title="Snap!"/>`;
			});
		}

		function buttonClicked() {
			updateImage();
		}

		let interval = undefined;
		function loop(cb) {
			// console.log("Loop function:", cb, cb.checked);
			if (cb.checked) {
				interval = window.setInterval(() => {
					updateImage();
				}, 2000);
			} else {
				window.clearInterval(interval);
			}
		}
	</script>
</head>
<body style="color: white; background: black;">

	<button onclick="buttonClicked();">Refresh</button> &nbsp; <input type="checkbox" onchange="loop(this);"> Loop.
	<div id="the-picture"></div>

</body>
</html>
